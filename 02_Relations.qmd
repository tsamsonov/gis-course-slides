---
title: "Основы геоинформатики"
subtitle: "Лекция 2: Пространственные отношения"
date: 10.02.2023
author: "Самсонов Тимофей Евгеньевич"
execute:
  echo: false
engine: knitr
format:
  revealjs: 
    theme: [default, custom.scss]
    slide-number: true
bibliography: references.yaml
---

## Пространственная привязка

**Пространственная привязка [@gost:70316-2022]**

:   Описание позиции в реальном мире.

Пространственная привязка может быть осуществлена двумя основными способами:

-   с использованием координат;
-   **посредством географических идентификаторов**.

::: callout-important
## Система координат

При использовании привязки по координатам необходимо описание системы координат.
:::

## Географические идентификаторы

Увязаны с местоположением, идентифицируемым географическими объектами. Взаимосвязь с объектом может быть установлена следующими основными способами:

-   **локализацией**, когда конкретная позиция находится внутри географического объекта, например в стране;

-   **локальными измерениями**, когда позиция определена относительно фиксированных точек географических объектов, например вдоль улицы на заданном расстоянии от пересечения с другой улицей. Этот аспект известен как *линейная привязка*;

-   **слабо связанным способом**, когда позиция имеет нечеткую взаимосвязь с географическими объектами, например рядом со зданием или между двумя зданиями.

## Создание объектов

Создание векторных пространственных объектов осуществляется разными способами. Наиболее распространены:

1.  **Автоматическое конструирование** на основе координат.

2.  **Геокодирование** --- преобразование географических идентификаторов в координаты.

3.  **Векторизация** --- создание объектов в ручном режиме, либо путем преобразования из других моделей данных.

    ::: callout-tip
    ## Уточнение

    Векторизации-преобразованию обычно подвергаются растровые данные.
    :::

4.  **Геометрические операции** --- получение новых векторных объектов в результате операций над существующими объектами.

## Пространственные отношения

Отношение

:   Свойство двух или более объектов, выраженное в наличии или отсутствии определенной связи между ними.

Пространственное отношение

:   Отношение пространственных объектов, значение которого зависит от их местоположения.

::: callout-note
## Предикат

Формальным представлением отношения является **предикат** --- функция, определенная на множестве объектов и принимающая для их упорядоченного набора значение **1** (`ИСТИНА`) или **0** (`ЛОЖЬ`). Предикаты пространственных отношений называются пространственными.
:::

## Пространственные отношения

К основным видам топологических отношений относятся:

1.  **Метрические** --- определяются расстояниями между объектами.

2.  **Топологические** --- определяются пересечениями объектов.

3.  **Дирекционные** --- определяются направлениями между объектами

::: callout-note
## Пространственные предикаты

Функции, которые устанавливают наличие метрических, топологических и дирекционных отношений, являются пространственными предикатами.
:::

## Расстояния

::: columns
::: {.column width="50%"}
#### Евклидово расстояние

Используется в плоских прямоугольных системах координат

$$
d(A,B) = \sqrt{(x_A - x_B)^2 + (y_A - y_B)^2}
$$

::: callout-warning
## Ограничения

Евклидово расстояние наследует искажения проекции, а также предполагает, что объекты доступны напрямую.
:::
:::

::: {.column width="50%"}
![](images/dist_euc.svg){fig-align="center" width="70%"}
:::
:::

## Расстояния

::: columns
::: {.column width="50%"}
#### Манхэттенское расстояние

Аппроксимирует реальное расстояние между точками в транспортных сетях с ортогональной планировкой.

$$
d(A,B) = |x_A - x_B| + |y_A - y_B|
$$

::: callout-warning
## Ограничения

Даёт преимущества только в том случае когда дорожная сеть ориентирована по направлениям осей $X$ и $Y$.
:::
:::

::: {.column width="50%"}
![](images/dist_manh.svg){width="70%" fig-align="center"}
:::
:::

## Расстояния

::: columns
::: {.column width="50%"}
#### Геодезические расстояние

Кратчайшее расстояние между точками на поверхности эллипсоида. Для сферы:

$$
d(A,B) = \\ \arccos ( 
\sin \phi_A \sin \phi_B + \\ 
\cos \phi_A \cos \phi_B \cos(\lambda_A - \lambda_B))
$$
:::

::: {.column width="50%"}
![](images/dist_geo.svg){fig-align="center" width="75%"}
:::
:::

::: callout-note
## Геодезическая линия и ортодромия

Линия кратчайшего расстояния *на эллипсоиде* --- **геодезическая**.\
Линия кратчайшего расстояния *на сфере* --- **ортодромия.**
:::

## Метрические отношения

**Метрические отношения** устанавливают расстояния между объектами с использованием выбранной метрики.

![](images/dist_all.svg){width="100%"}

::: callout-note
## Метрики

Для оценки расстояний может использоваться множество других метрик. Они не исчерпываются приведенными примерами.
:::

## Топологические отношения

Топологические отношения можно описать в терминах пересечения трех областей каждого объекта [@egenhofer1991]:

::: columns
::: {.column width="40%"}
-   Внутренняя область ($A^o$)

-   Граница ($\partial A$)

-   Внешняя область ($A^-$)
:::

::: {.column width="60%"}
![](images/egenhofer.svg){fig-align="left" width="70%"}
:::
:::

Матрица Эгенхофера **9-IM** содержит 0 или 1 в зависимости от наличия или отсутствия пересечения:

$$
\begin{bmatrix}
A^o  \cap B^o \ne \emptyset   &   A^o \cap \partial{B} \ne \emptyset & A^o \cap B^- \ne \emptyset \\
\partial{A} \cap B^o \ne \emptyset   &    \partial{A} \cap \partial{B} \ne \emptyset  &  \partial{A} \cap B^- \ne \emptyset \\
A^- \cap B^o \ne \emptyset    &    A^- \cap \partial{B} \ne \emptyset   &   A^-  \cap B^- \ne \emptyset
\end{bmatrix}
$$

## Топологические отношения

::: columns
::: {.column width="60%"}

Не пересекает

:   Внутренняя область и граница **A** не имеют пересечений с внутренней областью и границей **B**

$$
\begin{bmatrix} 
    0 & 0 & \bf{1} \\
    0 & 0 & \bf{1} \\
    \bf{1} & \bf{1} & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что объекты никак не соприкасаются в пространстве.
:::
:::

::: {.column width="40%"}
![](images/topo_disjoint.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Равен

:   Границы, внутренние и внешние области **A** пересекаются с *аналогичными* элементами **B**

$$
\begin{bmatrix} 
    \bf{1} & 0 & 0 \\
    0 & \bf{1} & 0 \\
    0 & 0 & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что объекты совпадают.
:::
:::

::: {.column width="40%"}
![](images/topo_equals.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Перекрывает

:   Все компоненты **A** пересекаются со всеми компонентами **B**

$$
\begin{bmatrix} 
    \bf{1} & \bf{1} & \bf{1} \\
    \bf{1} & \bf{1} & \bf{1} \\
    \bf{1} & \bf{1} & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что объекты имеют частичное перекрытие.
:::
:::

::: {.column width="40%"}
![](images/topo_overlaps.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Касается

:   Внутренняя область и граница **A** не пересекатся с внутренней областью **B** и наоборот.

$$
\begin{bmatrix} 
    0 & 0 & \bf{1} \\
    0 & \bf{1} & \bf{1} \\
    \bf{1} & \bf{1} & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что объекты касаются друг друга снаружи.
:::
:::

::: {.column width="40%"}
![](images/topo_touches.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Покрывает

:   Внешняя область **A** не пересекается с границей и внутренней областью **B**, остальные пересечения присутствуют.

$$
\begin{bmatrix} 
    \bf{1} & \bf{1} & \bf{1} \\
    0 & \bf{1} & \bf{1} \\
    0 & 0 & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что один объект содержит внутри себя другой объект, который касается его границы.
:::
:::

::: {.column width="40%"}
![](images/topo_covers.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Покрыт

:   Внешняя область **B** не пересекается с границей и внутренней областью **A**, остальные пересечения присутствуют.

$$
\begin{bmatrix} 
    \bf{1} & 0 & 0 \\
    \bf{1} & \bf{1} & 0 \\
    \bf{1} & \bf{1} & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что один объект содержится внутри другого объекта и касается его границы.
:::
:::

::: {.column width="40%"}
![](images/topo_covered.svg){width="70%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Содержит

:   Внешняя область и граница **A** не пересекается с границей и внутренней областью **B**, остальные пересечения присутствуют.

$$
\begin{bmatrix} 
    \bf{1} & \bf{1} & \bf{1} \\
    0 & 0 & \bf{1} \\
    0 & 0 & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что один объект содержит внутри себя другой объект.
:::
:::

::: {.column width="40%"}
![](images/topo_contains.svg){width="80%"}
:::
:::

## Топологические отношения

::: columns
::: {.column width="60%"}

Внутри

:   Внешняя область и граница **B** не пересекается с границей и внутренней областью **A**, остальные пересечения присутствуют.

$$
\begin{bmatrix} 
    \bf{1} & 0 & 0 \\
    \bf{1} & 0 & 0 \\
    \bf{1} & \bf{1} & \bf{1} \\
\end{bmatrix}
$$

::: callout-note
## Применение

Используется чтобы установить, что один объект содержится внутри другого объекта.
:::
:::

::: {.column width="40%"}
![](images/topo_within.svg){width="70%"}
:::
:::

## Топологические отношения

Пересекает

:   Внутренняя область или граница **A** пересекается с внутренней областью или границей **B**.

![](images/topo_all.svg){fig-align="center" width="100%"}

## Дирекционные отношения

::: columns
::: {.column width="50%"}
**Угловая модель** базируется на вычислении угла направления с точки **A** в точку **B**.

-   Как правило используется дирекционный угол или азимут.

::: callout-caution
## Ограничения

Применима только для точечных объектов
:::
:::

::: {.column width="50%"}
![](images/dir_ang.svg){width="70%"}
:::
:::

## Дирекционные отношения

::: columns
::: {.column width="60%"}
**Прямоугольная модель** разделяет плоскость на 9 секторов относительно прямоугольника, ограничивающего объект.

-   Используется минимальный ограничивающий прямоугольник со сторонами, параллельными осям координат.

::: callout-caution
## Ограничения

Дает качественную оценку направления по сторонам света
:::
:::

::: {.column width="40%"}
![](images/dir_mbr.svg){width="100%"}
:::
:::

## Дирекционные отношения

::: columns
::: {.column width="50%"}
**Проективная модель** используется для оценки направления на третий объект **C** относительно двух других объектов **A** и **B**.

-   Плоскость делится на 4 "конуса", а также область между объектами.

::: callout-caution
## Ограничения

Дает качественную оценку направления и применяется для *движущихся* объектов
:::
:::

::: {.column width="50%"}
![](images/dir_proj.svg){width="100%"}
:::
:::

## 

## Библиография
